<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đăng Ký</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-xl">
      <div class="bg-white rounded-2xl shadow-2xl p-10 space-y-8">
        <div class="text-center">
          <h2 class="text-3xl font-bold text-gray-800">Đăng Ký Tài Khoản</h2>
        </div>
        <form id="registerForm" class="space-y-6">
          <div class="flex gap-3">
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Tên tài khoản </label>
              <input
                type="text"
                id="username"
                class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
                placeholder="Nhập tên tài khoản"
              />
            </div>
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Họ và tên </label>
              <input
                type="text"
                id="name"
                class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
                placeholder="Nhập tên của bạn"
              />
            </div>
          </div>
          <div class="flex gap-3">
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Số điện thoại </label>
              <input
                type="text"
                id="phone"
                class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
                placeholder="Nhập số điện thoại"
              />
            </div>
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Địa chỉ </label>
              <select id="address" class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200">
                <option value="" disabled selected>-- Chọn tỉnh/thành phố --</option>
              </select>
            </div>
          </div>
          <div class="flex gap-3">
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Mật khẩu </label>
              <input
                type="password"
                id="password"
                class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
                placeholder="Nhập mật khẩu"
              />
            </div>
            <div class="w-1/2">
              <label class="block text-md font-medium text-gray-700 mb-2"> Nhập lại mật khẩu </label>
              <input
                type="password"
                id="enPassword"
                class="block w-full pl-5 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
                placeholder="Nhập mật khẩu"
              />
            </div>
          </div>
          <p id="error" class="text-sm text-red-500 font-medium text-center"></p>
          <p id="success" class="text-sm text-green-500 font-medium text-center"></p>
          <button
            type="submit"
            class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transform transition duration-200 hover:scale-105"
          >
            Đăng Ký
          </button>
          <p class="text-center text-sm text-gray-600">
            Quay lại
            <a href="/" class="text-blue-600 hover:text-blue-800 font-medium"> Đăng nhập </a>
          </p>
        </form>
      </div>
    </div>
  </body>
  <script>
    const address = [
      'An Giang',
      'Bắc Ninh',
      'Cà Mau',
      'Cao Bằng',
      'Cần Thơ',
      'Đà Nẵng',
      'Đắk Lắk',
      'Điện Biên',
      'Đồng Nai',
      'Đồng Tháp',
      'Gia Lai',
      'Hà Nội',
      'Hà Tĩnh',
      'Hải Phòng',
      'Huế',
      'Hưng Yên',
      'Khánh Hòa',
      'Lai Châu',
      'Lâm Đồng',
      'Lạng Sơn',
      'Lào Cai',
      'Nghệ An',
      'Ninh Bình',
      'Phú Thọ',
      'Quảng Ngãi',
      'Quảng Ninh',
      'Quảng Trị',
      'Sơn La',
      'Tây Ninh',
      'Thái Nguyên',
      'Thanh Hóa',
      'Hồ Chí Minh City',
      'Tuyên Quang',
      'Vĩnh Long',
    ];
    address.forEach((v) => {
      let option = document.createElement('option');
      option.value = v;
      option.text = v;
      document.getElementById('address').appendChild(option);
    });
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      const name = document.getElementById('name').value.trim();
      const password = document.getElementById('password').value;
      const enPassword = document.getElementById('enPassword').value;
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value;
      if (!username || !password || !enPassword || !name || !phone || !address) {
        document.getElementById('error').innerText = 'Vui lòng điền đầy đủ thông tin.';
        return;
      }
      if (!/^\d{10}$/.test(phone) || !phone.startsWith('0')) {
        document.getElementById('error').innerText = 'Số điện thoại không hợp lệ.';
        return;
      }
      if (password.length < 6) {
        document.getElementById('error').innerText = 'Mật khẩu phải có ít nhất 6 ký tự.';
        return;
      }
      if (password !== enPassword) {
        document.getElementById('error').innerText = 'Mật khẩu nhập lại không khớp.';
        return;
      }
      try {
        const res = await fetch('/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ username, password, name, phone, address }),
        });
        const result = await res.json();
        if (res.ok) {
          document.getElementById('success').innerText = result.success;
          document.getElementById('error').innerText = '';
        } else {
          document.getElementById('success').innerText = '';
          document.getElementById('error').innerText = result.error;
        }
      } catch (error) {
        document.getElementById('error').innerText = 'Server đang gặp sự cố. Vui lòng thử lại sau.';
      }
    });
  </script>
</html>
